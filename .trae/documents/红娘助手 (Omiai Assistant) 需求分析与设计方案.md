# 红娘助手 (Omiai Assistant) 项目规划方案

基于您的需求，我们旨在打造一个基于**微信生态**的高效客户管理与匹配系统。鉴于您及客户主要使用微信，且需要便捷的分享与数据收集功能，**微信小程序**是最佳的载体选择。

## 1. 核心应用载体：微信小程序 + Web管理后台（可选）

*   **微信小程序（核心）**：
    *   **红娘端（管理员）**：随时随地查看客户列表、快速筛选、生成邀请链接、查看匹配结果。
    *   **客户端（用户）**：点击链接直接进入小程序填写资料，无需下载安装，体验流畅。
*   **后端服务**：基于现有的 Go (`omiai-server`) 项目进行开发，保证高性能与数据安全。

## 2. 需求功能规划

### A. 客户资料收集（用户端）
*   **专属邀请链接**：红娘可生成带参数的链接发送给客户。
*   **智能表单**：根据您提供的模板，设计分步填写的表单（基础信息 -> 详细画像 -> 择偶标准）。
*   **照片上传**：支持上传生活照（对相亲至关重要）。
*   **隐私保护**：客户仅能编辑自己的档案，无法查看他人（除非红娘匹配推荐）。

### B. 红娘管理后台（红娘端）
*   **客户公海池**：展示8000+客户列表，支持按“更新时间”、“录入时间”排序。
*   **超级筛选器**：
    *   **基础筛选**：性别、年龄段、身高范围、学历、月收入。
    *   **高级筛选**：房车情况、属相、婚姻状况、居住地。
*   **智能匹配助手**：
    *   进入某位客户详情页，点击“**一键匹配**”，系统自动反向检索库中符合其“择偶要求”且“对方条件也匹配该客户”的异性列表。
*   **标签管理**：自定义标签（如：VIP、急找、本地土著等）。

## 3. 数据模型设计 (Database Schema)

我们将基于您提供的 CSV 字段构建数据库模型 `clients`：

| 字段分类 | 字段名 (中文) | 字段名 (English/Code) | 类型 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **基础信息** | 姓名 | `Name` | String | |
| | 性别 | `Gender` | Int | 1男 2女 |
| | 联系电话 | `Phone` | String | 索引字段，判重 |
| | 出生年月 | `Birthday` | Date | 用于计算年龄/属相 |
| | 属相 | `Zodiac` | String | 可自动计算，也可手动填 |
| | 身高 | `Height` | Int | 单位 cm |
| | 体重 | `Weight` | Int | 单位 kg |
| | 婚姻状况 | `MaritalStatus` | Int | 未婚/离异/丧偶 |
| **社会属性** | 学历 | `Education` | Int | 本科/硕士等 |
| | 月收入 | `MonthlyIncome` | Int | 范围或具体数值 |
| | 具体工作 | `Profession` | String | |
| | 房产情况 | `HouseStatus` | Int | 有房/无房/购房能力 |
| | 车辆情况 | `CarStatus` | Int | 有车/无车 |
| **家庭背景** | 家庭住址 | `Address` | String | |
| | 家庭成员 | `FamilyMembers` | String | 文本描述 |
| **择偶标准** | 对另一半要求 | `PartnerRequirements` | Text | 详细文本或结构化JSON |
| **管理字段** | 创建时间 | `CreatedAt` | Time | |
| | 备注 | `Remark` | Text | 红娘私有备注 |

## 4. 技术实施路线 (Roadmap)

我们将利用现有的 `omiai-server` 代码库进行迭代：

1.  **阶段一：基础设施搭建 (Infrastructure)**
    *   创建 `Client` 数据库表结构。
    *   定义 Go 结构体 (Model)。

2.  **阶段二：核心业务开发 (Core Logic)**
    *   开发 **新增/编辑客户** 接口 (API)。
    *   开发 **列表查询与筛选** 接口 (API) - 重点是多条件组合查询性能。
    *   开发 **详情查询** 接口。

3.  **阶段三：匹配算法 (Matching)**
    *   实现基于规则的匹配逻辑 (Rule-based Matching)。

## 下一步行动计划

待您确认本方案后，我将立即开始 **阶段一** 的工作：
1.  在 `internal/biz/omiai` 下创建客户模型。
2.  编写 SQL 迁移脚本以创建数据库表。
